import requests
import json

def query_the_last_samples(count):
    url = "https://mb-api.abuse.ch/api/v1/"
    payload = {'query': 'get_recent',
               'selector': count}
    headers = {}
    response = requests.request("POST", url, headers=headers, data=payload)
    return response.text

def query_hash(o_value):
    url = "https://mb-api.abuse.ch/api/v1/"
    payload = {'query': 'get_info',
               'hash': o_value}
    headers = {}
    response = requests.request("POST", url, headers=headers, data=payload)
    return response.text

def query_tag(tag):
    url = "https://mb-api.abuse.ch/api/v1/"
    payload = {'query': 'get_taginfo',
               'tag': tag,
               'limit': 100}
    headers = {}
    response = requests.request("POST", url, headers=headers, data=payload)
    data = response.text
    return data


